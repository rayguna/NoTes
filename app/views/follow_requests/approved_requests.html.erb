<h1><%= current_user.username %>'s Friends</h1>

<% friends = FollowRequest.where(status: "Accepted")
                           .where("sender_id = ? OR recipient_id = ?", current_user.id, current_user.id) %>

<div class="container mt-4">
  <div class="row">
    <div class="col-12">
      <div class="table-responsive">
        <table id="friends-table" class="table table-striped table-bordered table-hover">
          <thead class="thead-dark">
            <tr>
              <th scope="col">
                <%= link_to "Username".html_safe + (params[:sort] == 'username' && params[:direction] == 'asc' ? ' ▼' : ' ▲'), { sort: 'username', direction: (params[:sort] == 'username' && params[:direction] == 'asc' ? 'desc' : 'asc') }, data: { turbo_frame: "_top" } %>
              </th>
              <th scope="col">
                <%= link_to "Email".html_safe + (params[:sort] == 'email' && params[:direction] == 'asc' ? ' ▼' : ' ▲'), { sort: 'email', direction: (params[:sort] == 'email' && params[:direction] == 'asc' ? 'desc' : 'asc') }, data: { turbo_frame: "_top" } %>
              </th>
              <th scope="col">
                <%= link_to "Created At".html_safe + (params[:sort] == 'created_at' && params[:direction] == 'asc' ? ' ▼' : ' ▲'), { sort: 'created_at', direction: (params[:sort] == 'created_at' && params[:direction] == 'asc' ? 'desc' : 'asc') }, data: { turbo_frame: "_top" } %>
              </th>
              <th scope="col">
                <%= link_to "Modified At".html_safe + (params[:sort] == 'updated_at' && params[:direction] == 'asc' ? ' ▼' : ' ▲'), { sort: 'updated_at', direction: (params[:sort] == 'updated_at' && params[:direction] == 'asc' ? 'desc' : 'asc') }, data: { turbo_frame: "_top" } %>
              </th>
              <th scope="col">Select</th>
            </tr>
          </thead>
          <tbody>
            <% friends.each do |request| %>
              <% friend = request.sender_id == current_user.id ? User.find(request.recipient_id) : User.find(request.sender_id) %>
              <tr>
                <td><%= friend.username %></td>
                <td><%= friend.email %></td>
                <td><%= friend.created_at.strftime("%B %d, %Y") %></td>
                <td><%= friend.updated_at.strftime("%B %d, %Y") %></td>
                <td><input type="checkbox" name="friend_ids[]" value="<%= friend.id %>"></td>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<!-- Add custom styles inline or in your external stylesheet -->
<style>
  /* Custom styling for the table header */
  #friends-table thead {
    background-color: #343a40; /* Bootstrap's dark color */
    color: white;
  }

  /* Custom styling for table hover effect */
  #friends-table tbody tr:hover {
    background-color: #f8f9fa; /* Light background on hover */
  }
</style>
